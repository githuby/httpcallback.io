box: pjvds/golang

# Build definition
build:
  # The steps that will be executed on build
  steps:
    - script:
        name: setup golang
        code: |
          mkdir $HOME/mygo
          export GOPATH=$HOME/mygo
          export PATH=$PATH:$GOPATH/bin
          mkdir $GOPATH/bin
          mkdir $GOPATH/pkg
          if test "${WERCKER_GIT_REPOSTORY+set}" == set; then mkdir -p "$GOPATH/src/$WERCKER_GIT_DOMAIN/$WERCKER_GIT_OWNER/$WERCKER_GIT_REPOSTORY"; else ln -s $WERCKER_SOURCE_DIR $GOPATH/src; fi
          if test "${WERCKER_GIT_REPOSTORY+set}" == set; then cp -R $WERCKER_SOURCE_DIR/* "$GOPATH/src/$WERCKER_GIT_DOMAIN/$WERCKER_GIT_OWNER/$WERCKER_GIT_REPOSTORY"; fi
          if test "${WERCKER_GIT_REPOSTORY+set}" == set; then export WERCKER_ROOT="$GOPATH/src/$WERCKER_GIT_DOMAIN/$WERCKER_GIT_OWNER/$WERCKER_GIT_REPOSTORY"; fi
          if test "${WERCKER_GIT_REPOSTORY+set}" == set; then export WERCKER_SOURCE_DIR="$GOPATH/src/$WERCKER_GIT_DOMAIN/$WERCKER_GIT_OWNER/$WERCKER_GIT_REPOSTORY"; fi
    - script:
        name: go get
        code: |
          cd $WERCKER_SOURCE_DIR
          go version
          go get ./...
    - script:
        name: go build
        code: |
          go build .
    - script:
        name: go test
        code: |
          go test ./...
